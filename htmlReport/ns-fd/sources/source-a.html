<!--

    Copyright © 2016-2026 The Thingsboard Authors

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.

-->



<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> 
  <title>Coverage Report > Validator</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">org.thingsboard.server.dao.service</a>
</div>

<h1>Coverage Summary for Class: Validator (org.thingsboard.server.dao.service)</h1>

<table class="coverageStats">
<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Class, %
</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Branch, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">Validator</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/18)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/78)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/57)
  </span>
</td>
</tr>

</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;/**
&nbsp; * Copyright © 2016-2026 The Thingsboard Authors
&nbsp; *
&nbsp; * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
&nbsp; * you may not use this file except in compliance with the License.
&nbsp; * You may obtain a copy of the License at
&nbsp; *
&nbsp; *     http://www.apache.org/licenses/LICENSE-2.0
&nbsp; *
&nbsp; * Unless required by applicable law or agreed to in writing, software
&nbsp; * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
&nbsp; * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
&nbsp; * See the License for the specific language governing permissions and
&nbsp; * limitations under the License.
&nbsp; */
&nbsp;package org.thingsboard.server.dao.service;
&nbsp;
&nbsp;import org.apache.commons.lang3.StringUtils;
&nbsp;import org.thingsboard.common.util.RegexUtils;
&nbsp;import org.thingsboard.server.common.data.id.EntityId;
&nbsp;import org.thingsboard.server.common.data.id.UUIDBased;
&nbsp;import org.thingsboard.server.common.data.page.PageLink;
&nbsp;import org.thingsboard.server.common.data.query.EntityDataPageLink;
&nbsp;import org.thingsboard.server.common.data.query.EntityKey;
&nbsp;import org.thingsboard.server.common.data.query.EntityKeyType;
&nbsp;import org.thingsboard.server.dao.exception.IncorrectParameterException;
&nbsp;
&nbsp;import java.util.List;
&nbsp;import java.util.Set;
&nbsp;import java.util.UUID;
&nbsp;import java.util.function.Function;
&nbsp;import java.util.regex.Pattern;
&nbsp;
&nbsp;public final class Validator {
&nbsp;
&nbsp;    private Validator() {}
&nbsp;
<b class="nc">&nbsp;    public static final Pattern PROPERTY_PATTERN = Pattern.compile(&quot;^[\\p{L}0-9_-]+$&quot;); // Unicode letters, numbers, &#39;_&#39; and &#39;-&#39; allowed</b>
&nbsp;
&nbsp;    /**
&nbsp;     * This method validate &lt;code&gt;EntityId&lt;/code&gt; entity id. If entity id is invalid than throw
&nbsp;     * &lt;code&gt;IncorrectParameterException&lt;/code&gt; exception
&nbsp;     *
&nbsp;     * @param entityId      the entityId
&nbsp;     * @param errorMessage  the error message for exception
&nbsp;     */
&nbsp;    @Deprecated
&nbsp;    public static void validateEntityId(EntityId entityId, String errorMessage) {
<b class="nc">&nbsp;        if (entityId == null || entityId.getId() == null) {</b>
<b class="nc">&nbsp;            throw new IncorrectParameterException(errorMessage);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * This method validate &lt;code&gt;EntityId&lt;/code&gt; entity id. If entity id is invalid than throw
&nbsp;     * &lt;code&gt;IncorrectParameterException&lt;/code&gt; exception
&nbsp;     *
&nbsp;     * @param entityId              the entityId
&nbsp;     * @param errorMessageFunction  the error message function for exception that applies entityId
&nbsp;     */
&nbsp;    public static void validateEntityId(EntityId entityId, Function&lt;EntityId, String&gt; errorMessageFunction) {
<b class="nc">&nbsp;        if (entityId == null || entityId.getId() == null) {</b>
<b class="nc">&nbsp;            throw new IncorrectParameterException(errorMessageFunction.apply(entityId));</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * This method validate &lt;code&gt;String&lt;/code&gt; string. If string is invalid than throw
&nbsp;     * &lt;code&gt;IncorrectParameterException&lt;/code&gt; exception
&nbsp;     *
&nbsp;     * @param val           the val
&nbsp;     * @param errorMessage  the error message for exception
&nbsp;     */
&nbsp;    public static void validateString(String val, String errorMessage) {
<b class="nc">&nbsp;        if (val == null || val.isEmpty()) {</b>
<b class="nc">&nbsp;            throw new IncorrectParameterException(errorMessage);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * This method validate &lt;code&gt;String&lt;/code&gt; string. If string is invalid than throw
&nbsp;     * &lt;code&gt;IncorrectParameterException&lt;/code&gt; exception
&nbsp;     *
&nbsp;     * @param val                   the value
&nbsp;     * @param errorMessageFunction  the error message function that applies value
&nbsp;     */
&nbsp;    public static void validateString(String val, Function&lt;String, String&gt; errorMessageFunction) {
<b class="nc">&nbsp;        if (val == null || val.isEmpty()) {</b>
<b class="nc">&nbsp;            throw new IncorrectParameterException(errorMessageFunction.apply(val));</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * This method validate &lt;code&gt;long&lt;/code&gt; value. If value isn&#39;t positive than throw
&nbsp;     * &lt;code&gt;IncorrectParameterException&lt;/code&gt; exception
&nbsp;     *
&nbsp;     * @param val           the val
&nbsp;     * @param errorMessage  the error message for exception
&nbsp;     */
&nbsp;    public static void validatePositiveNumber(long val, String errorMessage) {
<b class="nc">&nbsp;        if (val &lt;= 0) {</b>
<b class="nc">&nbsp;            throw new IncorrectParameterException(errorMessage);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * This method validate &lt;code&gt;UUID&lt;/code&gt; id. If id is null than throw
&nbsp;     * &lt;code&gt;IncorrectParameterException&lt;/code&gt; exception
&nbsp;     *
&nbsp;     * @param id            the id
&nbsp;     * @param errorMessage  the error message for exception
&nbsp;     */
&nbsp;    @Deprecated
&nbsp;    public static void validateId(UUID id, String errorMessage) {
<b class="nc">&nbsp;        if (id == null) {</b>
<b class="nc">&nbsp;            throw new IncorrectParameterException(errorMessage);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * This method validate &lt;code&gt;UUID&lt;/code&gt; id. If id is null than throw
&nbsp;     * &lt;code&gt;IncorrectParameterException&lt;/code&gt; exception
&nbsp;     *
&nbsp;     * @param id                    the id
&nbsp;     * @param errorMessageFunction  the error message function for exception that applies id
&nbsp;     */
&nbsp;    public static void validateId(UUID id, Function&lt;UUID, String&gt; errorMessageFunction) {
<b class="nc">&nbsp;        if (id == null) {</b>
<b class="nc">&nbsp;            throw new IncorrectParameterException(errorMessageFunction.apply(id));</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * This method validate &lt;code&gt;UUIDBased&lt;/code&gt; id. If id is null than throw
&nbsp;     * &lt;code&gt;IncorrectParameterException&lt;/code&gt; exception
&nbsp;     *
&nbsp;     * @param id            the id
&nbsp;     * @param errorMessage  the error message for exception
&nbsp;     */
&nbsp;    @Deprecated
&nbsp;    public static void validateId(UUIDBased id, String errorMessage) {
<b class="nc">&nbsp;        if (id == null || id.getId() == null) {</b>
<b class="nc">&nbsp;            throw new IncorrectParameterException(errorMessage);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * This method validate &lt;code&gt;UUIDBased&lt;/code&gt; id. If id is null than throw
&nbsp;     * &lt;code&gt;IncorrectParameterException&lt;/code&gt; exception
&nbsp;     *
&nbsp;     * @param id                    the id
&nbsp;     * @param errorMessageFunction  the error message function for exception that applies id
&nbsp;     */
&nbsp;    public static void validateId(UUIDBased id, Function&lt;UUIDBased, String&gt; errorMessageFunction) {
<b class="nc">&nbsp;        if (id == null || id.getId() == null) {</b>
<b class="nc">&nbsp;            throw new IncorrectParameterException(errorMessageFunction.apply(id));</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * This method validate &lt;code&gt;UUIDBased&lt;/code&gt; id. If id is null than throw
&nbsp;     * &lt;code&gt;IncorrectParameterException&lt;/code&gt; exception
&nbsp;     *
&nbsp;     * @param id                    the id
&nbsp;     * @param ids                   the list of ids
&nbsp;     * @param errorMessageFunction  the error message function for exception that applies ids
&nbsp;     */
&nbsp;    static void validateId(UUIDBased id, List&lt;? extends UUIDBased&gt; ids, Function&lt;List&lt;? extends UUIDBased&gt;, String&gt; errorMessageFunction) {
<b class="nc">&nbsp;        if (id == null) {</b>
<b class="nc">&nbsp;            throw new IncorrectParameterException(errorMessageFunction.apply(ids));</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * This method validate list of &lt;code&gt;UUIDBased&lt;/code&gt; ids. If at least one of the ids is null than throw
&nbsp;     * &lt;code&gt;IncorrectParameterException&lt;/code&gt; exception
&nbsp;     *
&nbsp;     * @param ids           the list of ids
&nbsp;     * @param errorMessage  the error message for exception
&nbsp;     */
&nbsp;    @Deprecated
&nbsp;    public static void validateIds(List&lt;? extends UUIDBased&gt; ids, String errorMessage) {
<b class="nc">&nbsp;        if (ids == null || ids.isEmpty()) {</b>
<b class="nc">&nbsp;            throw new IncorrectParameterException(errorMessage);</b>
&nbsp;        } else {
<b class="nc">&nbsp;            for (UUIDBased id : ids) {</b>
<b class="nc">&nbsp;                validateId(id, errorMessage);</b>
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * This method validate list of &lt;code&gt;UUIDBased&lt;/code&gt; ids. If at least one of the ids is null than throw
&nbsp;     * &lt;code&gt;IncorrectParameterException&lt;/code&gt; exception
&nbsp;     *
&nbsp;     * @param ids                   the list of ids
&nbsp;     * @param errorMessageFunction  the error message function for exception that applies ids
&nbsp;     */
&nbsp;    public static void validateIds(List&lt;? extends UUIDBased&gt; ids, Function&lt;List&lt;? extends UUIDBased&gt;, String&gt; errorMessageFunction) {
<b class="nc">&nbsp;        if (ids == null || ids.isEmpty()) {</b>
<b class="nc">&nbsp;            throw new IncorrectParameterException(errorMessageFunction.apply(ids));</b>
&nbsp;        } else {
<b class="nc">&nbsp;            for (UUIDBased id : ids) {</b>
<b class="nc">&nbsp;                validateId(id, ids, errorMessageFunction);</b>
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Validates the specified PageLink object delegating to {@link #validatePageLink(PageLink, Set)}
&nbsp;     * with no restrictions on allowed sort properties.
&nbsp;     *
&nbsp;     * @param pageLink the PageLink object to validate
&nbsp;     * @throws IncorrectParameterException if the pageLink is null, has invalid page size,
&nbsp;     *                                   invalid page number, or invalid sort property
&nbsp;     * @see #validatePageLink(PageLink, Set)
&nbsp;     */
&nbsp;    public static void validatePageLink(PageLink pageLink) {
<b class="nc">&nbsp;        validatePageLink(pageLink, null);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Validates the specified PageLink object ensuring that:
&nbsp;     * &lt;ul&gt;
&nbsp;     * &lt;li&gt;The PageLink object is not null&lt;/li&gt;
&nbsp;     * &lt;li&gt;The page size is greater than zero&lt;/li&gt;
&nbsp;     * &lt;li&gt;The page number is non-negative&lt;/li&gt;
&nbsp;     * &lt;li&gt;If sorting is specified, the sort property is valid and allowed&lt;/li&gt;
&nbsp;     * &lt;/ul&gt;
&nbsp;     *
&nbsp;     * &lt;p&gt;When {@code allowedSortProperties} is provided, the sort property
&nbsp;     * must be contained within this set. If {@code allowedSortProperties} is null,
&nbsp;     * only basic sort property validation is performed.
&nbsp;     *
&nbsp;     * @param pageLink the PageLink object to validate.
&nbsp;     * @param allowedSortProperties a Set of allowed sort property names, or null to skip
&nbsp;     *                            this validation. If provided and the PageLink contains
&nbsp;     *                            a sort order, the sort property must be in this set.
&nbsp;     * @throws IncorrectParameterException if any of the following conditions are met:
&nbsp;     *         &lt;ul&gt;
&nbsp;     *         &lt;li&gt;{@code pageLink} is null&lt;/li&gt;
&nbsp;     *         &lt;li&gt;page size is less than 1&lt;/li&gt;
&nbsp;     *         &lt;li&gt;page number is negative&lt;/li&gt;
&nbsp;     *         &lt;li&gt;sort property is malformed&lt;/li&gt;
&nbsp;     *         &lt;li&gt;sort property is not in the {@code allowedSortProperties} set (when the set is provided and not null)&lt;/li&gt;
&nbsp;     *         &lt;/ul&gt;
&nbsp;     */
&nbsp;    public static void validatePageLink(PageLink pageLink, Set&lt;String&gt; allowedSortProperties) {
<b class="nc">&nbsp;        if (pageLink == null) {</b>
<b class="nc">&nbsp;            throw new IncorrectParameterException(&quot;Page link must be specified.&quot;);</b>
<b class="nc">&nbsp;        } else if (pageLink.getPageSize() &lt; 1) {</b>
<b class="nc">&nbsp;            throw new IncorrectParameterException(&quot;Incorrect page link page size &#39;&quot; + pageLink.getPageSize() + &quot;&#39;. Page size must be greater than zero.&quot;);</b>
<b class="nc">&nbsp;        } else if (pageLink.getPage() &lt; 0) {</b>
<b class="nc">&nbsp;            throw new IncorrectParameterException(&quot;Incorrect page link page &#39;&quot; + pageLink.getPage() + &quot;&#39;. Page must be positive integer.&quot;);</b>
<b class="nc">&nbsp;        } else if (pageLink.getSortOrder() != null) {</b>
<b class="nc">&nbsp;            String sortProperty = pageLink.getSortOrder().getProperty();</b>
<b class="nc">&nbsp;            if (!isValidProperty(sortProperty)) {</b>
<b class="nc">&nbsp;                throw new IncorrectParameterException(&quot;Invalid page link sort property&quot;);</b>
&nbsp;            }
<b class="nc">&nbsp;            if (allowedSortProperties != null &amp;&amp; !allowedSortProperties.contains(sortProperty)) {</b>
<b class="nc">&nbsp;                throw new IncorrectParameterException(</b>
<b class="nc">&nbsp;                        &quot;Unsupported sort property &#39;&quot; + sortProperty + &quot;&#39;. Only &#39;&quot; + String.join(&quot;&#39;, &#39;&quot;, allowedSortProperties) + &quot;&#39; are allowed.&quot;</b>
&nbsp;                );
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    public static void validateEntityDataPageLink(EntityDataPageLink pageLink) {
<b class="nc">&nbsp;        if (pageLink == null) {</b>
<b class="nc">&nbsp;            throw new IncorrectParameterException(&quot;Entity Data Page link must be specified.&quot;);</b>
<b class="nc">&nbsp;        } else if (pageLink.getPageSize() &lt; 1) {</b>
<b class="nc">&nbsp;            throw new IncorrectParameterException(&quot;Incorrect entity data page link page size &#39;&quot; + pageLink.getPageSize() + &quot;&#39;. Page size must be greater than zero.&quot;);</b>
<b class="nc">&nbsp;        } else if (pageLink.getPage() &lt; 0) {</b>
<b class="nc">&nbsp;            throw new IncorrectParameterException(&quot;Incorrect entity data page link page &#39;&quot; + pageLink.getPage() + &quot;&#39;. Page must be positive integer.&quot;);</b>
<b class="nc">&nbsp;        } else if (pageLink.getSortOrder() != null &amp;&amp; pageLink.getSortOrder().getKey() != null) {</b>
<b class="nc">&nbsp;            EntityKey sortKey = pageLink.getSortOrder().getKey();</b>
<b class="nc">&nbsp;            if ((sortKey.getType() == EntityKeyType.ENTITY_FIELD || sortKey.getType() == EntityKeyType.ALARM_FIELD)</b>
<b class="nc">&nbsp;                    &amp;&amp; !isValidProperty(sortKey.getKey())) {</b>
<b class="nc">&nbsp;                throw new IncorrectParameterException(&quot;Invalid entity data page link sort property&quot;);</b>
&nbsp;            }
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    public static boolean isValidProperty(String key) {
<b class="nc">&nbsp;        return StringUtils.isEmpty(key) || RegexUtils.matches(key, PROPERTY_PATTERN);</b>
&nbsp;    }
&nbsp;
&nbsp;    public static void checkNotNull(Object reference, String errorMessage) {
<b class="nc">&nbsp;        if (reference == null) {</b>
<b class="nc">&nbsp;            throw new IncorrectParameterException(errorMessage);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2026-02-07 20:03</div>
</div>
</body>
</html>
