<!--

    Copyright © 2016-2026 The Thingsboard Authors

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.

-->



<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> 
  <title>Coverage Report > EntitiesVersionControlController</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">org.thingsboard.server.controller</a>
</div>

<h1>Coverage Summary for Class: EntitiesVersionControlController (org.thingsboard.server.controller)</h1>

<table class="coverageStats">
<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Class, %
</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Branch, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">EntitiesVersionControlController</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/14)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/4)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/46)
  </span>
</td>
</tr>

</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;/**
&nbsp; * Copyright © 2016-2026 The Thingsboard Authors
&nbsp; *
&nbsp; * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
&nbsp; * you may not use this file except in compliance with the License.
&nbsp; * You may obtain a copy of the License at
&nbsp; *
&nbsp; *     http://www.apache.org/licenses/LICENSE-2.0
&nbsp; *
&nbsp; * Unless required by applicable law or agreed to in writing, software
&nbsp; * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
&nbsp; * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
&nbsp; * See the License for the specific language governing permissions and
&nbsp; * limitations under the License.
&nbsp; */
&nbsp;package org.thingsboard.server.controller;
&nbsp;
&nbsp;import com.google.common.util.concurrent.Futures;
&nbsp;import com.google.common.util.concurrent.ListenableFuture;
&nbsp;import com.google.common.util.concurrent.MoreExecutors;
&nbsp;import io.swagger.v3.oas.annotations.Parameter;
&nbsp;import io.swagger.v3.oas.annotations.media.Schema;
&nbsp;import lombok.RequiredArgsConstructor;
&nbsp;import org.springframework.beans.factory.annotation.Value;
&nbsp;import org.springframework.security.access.prepost.PreAuthorize;
&nbsp;import org.springframework.web.bind.annotation.GetMapping;
&nbsp;import org.springframework.web.bind.annotation.PathVariable;
&nbsp;import org.springframework.web.bind.annotation.PostMapping;
&nbsp;import org.springframework.web.bind.annotation.RequestBody;
&nbsp;import org.springframework.web.bind.annotation.RequestMapping;
&nbsp;import org.springframework.web.bind.annotation.RequestParam;
&nbsp;import org.springframework.web.bind.annotation.RestController;
&nbsp;import org.springframework.web.context.request.async.DeferredResult;
&nbsp;import org.thingsboard.server.common.data.EntityType;
&nbsp;import org.thingsboard.server.common.data.StringUtils;
&nbsp;import org.thingsboard.server.common.data.id.EntityId;
&nbsp;import org.thingsboard.server.common.data.id.EntityIdFactory;
&nbsp;import org.thingsboard.server.common.data.id.TenantId;
&nbsp;import org.thingsboard.server.common.data.page.PageData;
&nbsp;import org.thingsboard.server.common.data.page.PageLink;
&nbsp;import org.thingsboard.server.common.data.sync.vc.BranchInfo;
&nbsp;import org.thingsboard.server.common.data.sync.vc.EntityDataDiff;
&nbsp;import org.thingsboard.server.common.data.sync.vc.EntityDataInfo;
&nbsp;import org.thingsboard.server.common.data.sync.vc.EntityVersion;
&nbsp;import org.thingsboard.server.common.data.sync.vc.VersionCreationResult;
&nbsp;import org.thingsboard.server.common.data.sync.vc.VersionLoadResult;
&nbsp;import org.thingsboard.server.common.data.sync.vc.VersionedEntityInfo;
&nbsp;import org.thingsboard.server.common.data.sync.vc.request.create.VersionCreateRequest;
&nbsp;import org.thingsboard.server.common.data.sync.vc.request.load.VersionLoadRequest;
&nbsp;import org.thingsboard.server.config.annotations.ApiOperation;
&nbsp;import org.thingsboard.server.queue.util.TbCoreComponent;
&nbsp;import org.thingsboard.server.service.security.model.SecurityUser;
&nbsp;import org.thingsboard.server.service.security.permission.Operation;
&nbsp;import org.thingsboard.server.service.security.permission.Resource;
&nbsp;import org.thingsboard.server.service.sync.vc.EntitiesVersionControlService;
&nbsp;
&nbsp;import java.util.ArrayList;
&nbsp;import java.util.List;
&nbsp;import java.util.UUID;
&nbsp;import java.util.stream.Collectors;
&nbsp;
&nbsp;import static org.thingsboard.server.controller.ControllerConstants.BRANCH_PARAM_DESCRIPTION;
&nbsp;import static org.thingsboard.server.controller.ControllerConstants.ENTITY_ID_PARAM_DESCRIPTION;
&nbsp;import static org.thingsboard.server.controller.ControllerConstants.ENTITY_TYPE_PARAM_DESCRIPTION;
&nbsp;import static org.thingsboard.server.controller.ControllerConstants.ENTITY_VERSION_TEXT_SEARCH_DESCRIPTION;
&nbsp;import static org.thingsboard.server.controller.ControllerConstants.MARKDOWN_CODE_BLOCK_END;
&nbsp;import static org.thingsboard.server.controller.ControllerConstants.MARKDOWN_CODE_BLOCK_START;
&nbsp;import static org.thingsboard.server.controller.ControllerConstants.NEW_LINE;
&nbsp;import static org.thingsboard.server.controller.ControllerConstants.PAGE_DATA_PARAMETERS;
&nbsp;import static org.thingsboard.server.controller.ControllerConstants.PAGE_NUMBER_DESCRIPTION;
&nbsp;import static org.thingsboard.server.controller.ControllerConstants.PAGE_SIZE_DESCRIPTION;
&nbsp;import static org.thingsboard.server.controller.ControllerConstants.SORT_ORDER_DESCRIPTION;
&nbsp;import static org.thingsboard.server.controller.ControllerConstants.SORT_PROPERTY_DESCRIPTION;
&nbsp;import static org.thingsboard.server.controller.ControllerConstants.TENANT_AUTHORITY_PARAGRAPH;
&nbsp;import static org.thingsboard.server.controller.ControllerConstants.VC_REQUEST_ID_PARAM_DESCRIPTION;
&nbsp;import static org.thingsboard.server.controller.ControllerConstants.VERSION_ID_PARAM_DESCRIPTION;
&nbsp;
&nbsp;@RestController
&nbsp;@TbCoreComponent
&nbsp;@RequestMapping(&quot;/api/entities/vc&quot;)
&nbsp;@PreAuthorize(&quot;hasAuthority(&#39;TENANT_ADMIN&#39;)&quot;)
&nbsp;@RequiredArgsConstructor
&nbsp;public class EntitiesVersionControlController extends BaseController {
&nbsp;
&nbsp;    private final EntitiesVersionControlService versionControlService;
&nbsp;
&nbsp;    @Value(&quot;${queue.vc.request-timeout:180000}&quot;)
&nbsp;    private int vcRequestTimeout;
&nbsp;
&nbsp;    @ApiOperation(value = &quot;Save entities version (saveEntitiesVersion)&quot;, notes = &quot;&quot; +
&nbsp;            &quot;Creates a new version of entities (or a single entity) by request.\n&quot; +
&nbsp;            &quot;Supported entity types: CUSTOMER, ASSET, RULE_CHAIN, DASHBOARD, DEVICE_PROFILE, DEVICE, ENTITY_VIEW, WIDGETS_BUNDLE.&quot; + NEW_LINE +
&nbsp;            &quot;There are two available types of request: `SINGLE_ENTITY` and `COMPLEX`. &quot; +
&nbsp;            &quot;Each of them contains version name (`versionName`) and name of a branch (`branch`) to create version (commit) in. &quot; +
&nbsp;            &quot;If specified branch does not exists in a remote repo, then new empty branch will be created. &quot; +
&nbsp;            &quot;Request of the `SINGLE_ENTITY` type has id of an entity (`entityId`) and additional configuration (`config`) &quot; +
&nbsp;            &quot;which has following options: \n&quot; +
&nbsp;            &quot;- `saveRelations` - whether to add inbound and outbound relations of type COMMON to created entity version;\n&quot; +
&nbsp;            &quot;- `saveAttributes` - to save attributes of server scope (and also shared scope for devices);\n&quot; +
&nbsp;            &quot;- `saveCredentials` - when saving a version of a device, to add its credentials to the version.&quot; + NEW_LINE +
&nbsp;            &quot;An example of a `SINGLE_ENTITY` version create request:\n&quot; +
&nbsp;            MARKDOWN_CODE_BLOCK_START +
&nbsp;            &quot;{\n&quot; +
&nbsp;            &quot;  \&quot;type\&quot;: \&quot;SINGLE_ENTITY\&quot;,\n&quot; +
&nbsp;            &quot;\n&quot; +
&nbsp;            &quot;  \&quot;versionName\&quot;: \&quot;Version 1.0\&quot;,\n&quot; +
&nbsp;            &quot;  \&quot;branch\&quot;: \&quot;dev\&quot;,\n&quot; +
&nbsp;            &quot;\n&quot; +
&nbsp;            &quot;  \&quot;entityId\&quot;: {\n&quot; +
&nbsp;            &quot;    \&quot;entityType\&quot;: \&quot;DEVICE\&quot;,\n&quot; +
&nbsp;            &quot;    \&quot;id\&quot;: \&quot;b79448e0-d4f4-11ec-847b-0f432358ab48\&quot;\n&quot; +
&nbsp;            &quot;  },\n&quot; +
&nbsp;            &quot;  \&quot;config\&quot;: {\n&quot; +
&nbsp;            &quot;    \&quot;saveRelations\&quot;: true,\n&quot; +
&nbsp;            &quot;    \&quot;saveAttributes\&quot;: true,\n&quot; +
&nbsp;            &quot;    \&quot;saveCredentials\&quot;: false\n&quot; +
&nbsp;            &quot;  }\n&quot; +
&nbsp;            &quot;}&quot; +
&nbsp;            MARKDOWN_CODE_BLOCK_END + NEW_LINE +
&nbsp;            &quot;Second request type (`COMPLEX`), additionally to `branch` and `versionName`, contains following properties:\n&quot; +
&nbsp;            &quot;- `entityTypes` - a structure with entity types to export and configuration for each entity type; &quot; +
&nbsp;            &quot;   this configuration has all the options available for `SINGLE_ENTITY` and additionally has these ones: \n&quot; +
&nbsp;            &quot;     - `allEntities` and `entityIds` - if you want to save the version of all entities of the entity type &quot; +
&nbsp;            &quot;        then set `allEntities` param to true, otherwise set it to false and specify the list of specific entities (`entityIds`);\n&quot; +
&nbsp;            &quot;     - `syncStrategy` - synchronization strategy to use for this entity type: when set to `OVERWRITE` &quot; +
&nbsp;            &quot;        then the list of remote entities of this type will be overwritten by newly added entities. If set to &quot; +
&nbsp;            &quot;        `MERGE` - existing remote entities of this entity type will not be removed, new entities will just &quot; +
&nbsp;            &quot;        be added on top (or existing remote entities will be updated).\n&quot; +
&nbsp;            &quot;- `syncStrategy` - default synchronization strategy to use when it is not specified for an entity type.&quot; + NEW_LINE +
&nbsp;            &quot;Example for this type of request:\n&quot; +
&nbsp;            MARKDOWN_CODE_BLOCK_START +
&nbsp;            &quot;{\n&quot; +
&nbsp;            &quot;  \&quot;type\&quot;: \&quot;COMPLEX\&quot;,\n&quot; +
&nbsp;            &quot;\n&quot; +
&nbsp;            &quot;  \&quot;versionName\&quot;: \&quot;Devices and profiles: release 2\&quot;,\n&quot; +
&nbsp;            &quot;  \&quot;branch\&quot;: \&quot;master\&quot;,\n&quot; +
&nbsp;            &quot;\n&quot; +
&nbsp;            &quot;  \&quot;syncStrategy\&quot;: \&quot;OVERWRITE\&quot;,\n&quot; +
&nbsp;            &quot;  \&quot;entityTypes\&quot;: {\n&quot; +
&nbsp;            &quot;    \&quot;DEVICE\&quot;: {\n&quot; +
&nbsp;            &quot;      \&quot;syncStrategy\&quot;: null,\n&quot; +
&nbsp;            &quot;      \&quot;allEntities\&quot;: true,\n&quot; +
&nbsp;            &quot;      \&quot;saveRelations\&quot;: true,\n&quot; +
&nbsp;            &quot;      \&quot;saveAttributes\&quot;: true,\n&quot; +
&nbsp;            &quot;      \&quot;saveCredentials\&quot;: true\n&quot; +
&nbsp;            &quot;    },\n&quot; +
&nbsp;            &quot;    \&quot;DEVICE_PROFILE\&quot;: {\n&quot; +
&nbsp;            &quot;      \&quot;syncStrategy\&quot;: \&quot;MERGE\&quot;,\n&quot; +
&nbsp;            &quot;      \&quot;allEntities\&quot;: false,\n&quot; +
&nbsp;            &quot;      \&quot;entityIds\&quot;: [\n&quot; +
&nbsp;            &quot;        \&quot;b79448e0-d4f4-11ec-847b-0f432358ab48\&quot;\n&quot; +
&nbsp;            &quot;      ],\n&quot; +
&nbsp;            &quot;      \&quot;saveRelations\&quot;: true\n&quot; +
&nbsp;            &quot;    }\n&quot; +
&nbsp;            &quot;  }\n&quot; +
&nbsp;            &quot;}&quot; +
&nbsp;            MARKDOWN_CODE_BLOCK_END + NEW_LINE +
&nbsp;            &quot;Response wil contain generated request UUID, that can be then used to retrieve &quot; +
&nbsp;            &quot;status of operation via `getVersionCreateRequestStatus`.\n&quot; +
&nbsp;            TENANT_AUTHORITY_PARAGRAPH)
&nbsp;    @PostMapping(&quot;/version&quot;)
&nbsp;    public DeferredResult&lt;UUID&gt; saveEntitiesVersion(@RequestBody VersionCreateRequest request) throws Exception {
<b class="nc">&nbsp;        SecurityUser user = getCurrentUser();</b>
<b class="nc">&nbsp;        accessControlService.checkPermission(getCurrentUser(), Resource.VERSION_CONTROL, Operation.WRITE);</b>
<b class="nc">&nbsp;        return wrapFuture(versionControlService.saveEntitiesVersion(user, request));</b>
&nbsp;    }
&nbsp;
&nbsp;    @ApiOperation(value = &quot;Get version create request status (getVersionCreateRequestStatus)&quot;, notes = &quot;&quot; +
&nbsp;            &quot;Returns the status of previously made version create request. &quot; + NEW_LINE +
&nbsp;            &quot;This status contains following properties:\n&quot; +
&nbsp;            &quot;- `done` - whether request processing is finished;\n&quot; +
&nbsp;            &quot;- `version` - created version info: timestamp, version id (commit hash), commit name and commit author;\n&quot; +
&nbsp;            &quot;- `added` - count of items that were created in the remote repo;\n&quot; +
&nbsp;            &quot;- `modified` - modified items count;\n&quot; +
&nbsp;            &quot;- `removed` - removed items count;\n&quot; +
&nbsp;            &quot;- `error` - error message, if an error occurred while handling the request.&quot; + NEW_LINE +
&nbsp;            &quot;An example of successful status:\n&quot; +
&nbsp;            MARKDOWN_CODE_BLOCK_START +
&nbsp;            &quot;{\n&quot; +
&nbsp;            &quot;  \&quot;done\&quot;: true,\n&quot; +
&nbsp;            &quot;  \&quot;added\&quot;: 10,\n&quot; +
&nbsp;            &quot;  \&quot;modified\&quot;: 2,\n&quot; +
&nbsp;            &quot;  \&quot;removed\&quot;: 5,\n&quot; +
&nbsp;            &quot;  \&quot;version\&quot;: {\n&quot; +
&nbsp;            &quot;    \&quot;timestamp\&quot;: 1655198528000,\n&quot; +
&nbsp;            &quot;    \&quot;id\&quot;:\&quot;8a834dd389ed80e0759ba8ee338b3f1fd160a114\&quot;,\n&quot; +
&nbsp;            &quot;    \&quot;name\&quot;: \&quot;My devices v2.0\&quot;,\n&quot; +
&nbsp;            &quot;    \&quot;author\&quot;: \&quot;John Doe\&quot;\n&quot; +
&nbsp;            &quot;  },\n&quot; +
&nbsp;            &quot;  \&quot;error\&quot;: null\n&quot; +
&nbsp;            &quot;}&quot; +
&nbsp;            MARKDOWN_CODE_BLOCK_END +
&nbsp;            TENANT_AUTHORITY_PARAGRAPH)
&nbsp;    @GetMapping(value = &quot;/version/{requestId}/status&quot;)
&nbsp;    public VersionCreationResult getVersionCreateRequestStatus(@Parameter(description = VC_REQUEST_ID_PARAM_DESCRIPTION, required = true)
&nbsp;                                                               @PathVariable UUID requestId) throws Exception {
<b class="nc">&nbsp;        accessControlService.checkPermission(getCurrentUser(), Resource.VERSION_CONTROL, Operation.WRITE);</b>
<b class="nc">&nbsp;        return versionControlService.getVersionCreateStatus(getCurrentUser(), requestId);</b>
&nbsp;    }
&nbsp;
&nbsp;    @ApiOperation(value = &quot;List entity versions (listEntityVersions)&quot;, notes = &quot;&quot; +
&nbsp;            &quot;Returns list of versions for a specific entity in a concrete branch. \n&quot; +
&nbsp;            &quot;You need to specify external id of an entity to list versions for. This is `externalId` property of an entity, &quot; +
&nbsp;            &quot;or otherwise if not set - simply id of this entity. \n&quot; +
&nbsp;            &quot;If specified branch does not exist - empty page data will be returned. &quot; + NEW_LINE +
&nbsp;            &quot;Each version info item has timestamp, id, name and author. Version id can then be used to restore the version. &quot; +
&nbsp;            PAGE_DATA_PARAMETERS + NEW_LINE +
&nbsp;            &quot;Response example: \n&quot; +
&nbsp;            MARKDOWN_CODE_BLOCK_START +
&nbsp;            &quot;{\n&quot; +
&nbsp;            &quot;  \&quot;data\&quot;: [\n&quot; +
&nbsp;            &quot;    {\n&quot; +
&nbsp;            &quot;      \&quot;timestamp\&quot;: 1655198593000,\n&quot; +
&nbsp;            &quot;      \&quot;id\&quot;: \&quot;fd82625bdd7d6131cf8027b44ee967012ecaf990\&quot;,\n&quot; +
&nbsp;            &quot;      \&quot;name\&quot;: \&quot;Devices and assets - v2.0\&quot;,\n&quot; +
&nbsp;            &quot;      \&quot;author\&quot;: \&quot;John Doe &lt;johndoe@gmail.com&gt;\&quot;\n&quot; +
&nbsp;            &quot;    },\n&quot; +
&nbsp;            &quot;    {\n&quot; +
&nbsp;            &quot;      \&quot;timestamp\&quot;: 1655198528000,\n&quot; +
&nbsp;            &quot;      \&quot;id\&quot;: \&quot;682adcffa9c8a2f863af6f00c4850323acbd4219\&quot;,\n&quot; +
&nbsp;            &quot;      \&quot;name\&quot;: \&quot;Update my device\&quot;,\n&quot; +
&nbsp;            &quot;      \&quot;author\&quot;: \&quot;John Doe &lt;johndoe@gmail.com&gt;\&quot;\n&quot; +
&nbsp;            &quot;    },\n&quot; +
&nbsp;            &quot;    {\n&quot; +
&nbsp;            &quot;      \&quot;timestamp\&quot;: 1655198280000,\n&quot; +
&nbsp;            &quot;      \&quot;id\&quot;: \&quot;d2a6087c2b30e18cc55e7cdda345a8d0dfb959a4\&quot;,\n&quot; +
&nbsp;            &quot;      \&quot;name\&quot;: \&quot;Devices and assets - v1.0\&quot;,\n&quot; +
&nbsp;            &quot;      \&quot;author\&quot;: \&quot;John Doe &lt;johndoe@gmail.com&gt;\&quot;\n&quot; +
&nbsp;            &quot;    }\n&quot; +
&nbsp;            &quot;  ],\n&quot; +
&nbsp;            &quot;  \&quot;totalPages\&quot;: 1,\n&quot; +
&nbsp;            &quot;  \&quot;totalElements\&quot;: 3,\n&quot; +
&nbsp;            &quot;  \&quot;hasNext\&quot;: false\n&quot; +
&nbsp;            &quot;}&quot; +
&nbsp;            MARKDOWN_CODE_BLOCK_END +
&nbsp;            TENANT_AUTHORITY_PARAGRAPH)
&nbsp;    @GetMapping(value = &quot;/version/{entityType}/{externalEntityUuid}&quot;, params = {&quot;branch&quot;, &quot;pageSize&quot;, &quot;page&quot;})
&nbsp;    public DeferredResult&lt;PageData&lt;EntityVersion&gt;&gt; listEntityVersions(@Parameter(description = ENTITY_TYPE_PARAM_DESCRIPTION, required = true)
&nbsp;                                                                      @PathVariable EntityType entityType,
&nbsp;                                                                      @Parameter(description = &quot;A string value representing external entity id. This is `externalId` property of an entity, or otherwise if not set - simply id of this entity.&quot;)
&nbsp;                                                                      @PathVariable UUID externalEntityUuid,
&nbsp;                                                                      @Parameter(description = BRANCH_PARAM_DESCRIPTION)
&nbsp;                                                                      @RequestParam String branch,
&nbsp;                                                                      @Parameter(description = PAGE_SIZE_DESCRIPTION, required = true)
&nbsp;                                                                      @RequestParam int pageSize,
&nbsp;                                                                      @Parameter(description = PAGE_NUMBER_DESCRIPTION, required = true)
&nbsp;                                                                      @RequestParam int page,
&nbsp;                                                                      @Parameter(description = ENTITY_VERSION_TEXT_SEARCH_DESCRIPTION)
&nbsp;                                                                      @RequestParam(required = false) String textSearch,
&nbsp;                                                                      @Parameter(description = SORT_PROPERTY_DESCRIPTION, schema = @Schema(allowableValues = &quot;timestamp&quot;))
&nbsp;                                                                      @RequestParam(required = false) String sortProperty,
&nbsp;                                                                      @Parameter(description = SORT_ORDER_DESCRIPTION, schema = @Schema(allowableValues = {&quot;ASC&quot;, &quot;DESC&quot;}))
&nbsp;                                                                      @RequestParam(required = false) String sortOrder) throws Exception {
<b class="nc">&nbsp;        accessControlService.checkPermission(getCurrentUser(), Resource.VERSION_CONTROL, Operation.READ);</b>
<b class="nc">&nbsp;        EntityId externalEntityId = EntityIdFactory.getByTypeAndUuid(entityType, externalEntityUuid);</b>
<b class="nc">&nbsp;        PageLink pageLink = createPageLink(pageSize, page, textSearch, sortProperty, sortOrder);</b>
<b class="nc">&nbsp;        return wrapFuture(versionControlService.listEntityVersions(getTenantId(), branch, externalEntityId, pageLink));</b>
&nbsp;    }
&nbsp;
&nbsp;    @ApiOperation(value = &quot;List entity type versions (listEntityTypeVersions)&quot;, notes = &quot;&quot; +
&nbsp;            &quot;Returns list of versions of an entity type in a branch. This is a collected list of versions that were created &quot; +
&nbsp;            &quot;for entities of this type in a remote branch. \n&quot; +
&nbsp;            &quot;If specified branch does not exist - empty page data will be returned. &quot; +
&nbsp;            &quot;The response structure is the same as for `listEntityVersions` API method.&quot; +
&nbsp;            TENANT_AUTHORITY_PARAGRAPH)
&nbsp;    @GetMapping(value = &quot;/version/{entityType}&quot;, params = {&quot;branch&quot;, &quot;pageSize&quot;, &quot;page&quot;})
&nbsp;    public DeferredResult&lt;PageData&lt;EntityVersion&gt;&gt; listEntityTypeVersions(@Parameter(description = ENTITY_TYPE_PARAM_DESCRIPTION, required = true)
&nbsp;                                                                          @PathVariable EntityType entityType,
&nbsp;                                                                          @Parameter(description = BRANCH_PARAM_DESCRIPTION, required = true)
&nbsp;                                                                          @RequestParam String branch,
&nbsp;                                                                          @Parameter(description = PAGE_SIZE_DESCRIPTION, required = true)
&nbsp;                                                                          @RequestParam int pageSize,
&nbsp;                                                                          @Parameter(description = PAGE_NUMBER_DESCRIPTION, required = true)
&nbsp;                                                                          @RequestParam int page,
&nbsp;                                                                          @Parameter(description = ENTITY_VERSION_TEXT_SEARCH_DESCRIPTION)
&nbsp;                                                                          @RequestParam(required = false) String textSearch,
&nbsp;                                                                          @Parameter(description = SORT_PROPERTY_DESCRIPTION, schema = @Schema(allowableValues = &quot;timestamp&quot;))
&nbsp;                                                                          @RequestParam(required = false) String sortProperty,
&nbsp;                                                                          @Parameter(description = SORT_ORDER_DESCRIPTION, schema = @Schema(allowableValues = {&quot;ASC&quot;, &quot;DESC&quot;}))
&nbsp;                                                                          @RequestParam(required = false) String sortOrder) throws Exception {
<b class="nc">&nbsp;        accessControlService.checkPermission(getCurrentUser(), Resource.VERSION_CONTROL, Operation.READ);</b>
<b class="nc">&nbsp;        PageLink pageLink = createPageLink(pageSize, page, textSearch, sortProperty, sortOrder);</b>
<b class="nc">&nbsp;        return wrapFuture(versionControlService.listEntityTypeVersions(getTenantId(), branch, entityType, pageLink));</b>
&nbsp;    }
&nbsp;
&nbsp;    @ApiOperation(value = &quot;List all versions (listVersions)&quot;, notes = &quot;&quot; +
&nbsp;            &quot;Lists all available versions in a branch for all entity types. \n&quot; +
&nbsp;            &quot;If specified branch does not exist - empty page data will be returned. &quot; +
&nbsp;            &quot;The response format is the same as for `listEntityVersions` API method.&quot; +
&nbsp;            TENANT_AUTHORITY_PARAGRAPH)
&nbsp;    @GetMapping(value = &quot;/version&quot;, params = {&quot;branch&quot;, &quot;pageSize&quot;, &quot;page&quot;})
&nbsp;    public DeferredResult&lt;PageData&lt;EntityVersion&gt;&gt; listVersions(@Parameter(description = BRANCH_PARAM_DESCRIPTION, required = true)
&nbsp;                                                                @RequestParam String branch,
&nbsp;                                                                @Parameter(description = PAGE_SIZE_DESCRIPTION, required = true)
&nbsp;                                                                @RequestParam int pageSize,
&nbsp;                                                                @Parameter(description = PAGE_NUMBER_DESCRIPTION, required = true)
&nbsp;                                                                @RequestParam int page,
&nbsp;                                                                @Parameter(description = ENTITY_VERSION_TEXT_SEARCH_DESCRIPTION)
&nbsp;                                                                @RequestParam(required = false) String textSearch,
&nbsp;                                                                @Parameter(description = SORT_PROPERTY_DESCRIPTION, schema = @Schema(allowableValues = &quot;timestamp&quot;))
&nbsp;                                                                @RequestParam(required = false) String sortProperty,
&nbsp;                                                                @Parameter(description = SORT_ORDER_DESCRIPTION, schema = @Schema(allowableValues = {&quot;ASC&quot;, &quot;DESC&quot;}))
&nbsp;                                                                @RequestParam(required = false) String sortOrder) throws Exception {
<b class="nc">&nbsp;        accessControlService.checkPermission(getCurrentUser(), Resource.VERSION_CONTROL, Operation.READ);</b>
<b class="nc">&nbsp;        PageLink pageLink = createPageLink(pageSize, page, textSearch, sortProperty, sortOrder);</b>
<b class="nc">&nbsp;        return wrapFuture(versionControlService.listVersions(getTenantId(), branch, pageLink));</b>
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;    @ApiOperation(value = &quot;List entities at version (listEntitiesAtVersion)&quot;, notes = &quot;&quot; +
&nbsp;            &quot;Returns a list of remote entities of a specific entity type that are available at a concrete version. \n&quot; +
&nbsp;            &quot;Each entity item in the result has `externalId` property. &quot; +
&nbsp;            &quot;Entities order will be the same as in the repository.&quot; +
&nbsp;            TENANT_AUTHORITY_PARAGRAPH)
&nbsp;    @GetMapping(value = &quot;/entity/{entityType}/{versionId}&quot;)
&nbsp;    public DeferredResult&lt;List&lt;VersionedEntityInfo&gt;&gt; listEntitiesAtVersion(@Parameter(description = ENTITY_TYPE_PARAM_DESCRIPTION, required = true)
&nbsp;                                                                           @PathVariable EntityType entityType,
&nbsp;                                                                           @Parameter(description = VERSION_ID_PARAM_DESCRIPTION, required = true)
&nbsp;                                                                           @PathVariable String versionId) throws Exception {
<b class="nc">&nbsp;        accessControlService.checkPermission(getCurrentUser(), Resource.VERSION_CONTROL, Operation.READ);</b>
<b class="nc">&nbsp;        return wrapFuture(versionControlService.listEntitiesAtVersion(getTenantId(), versionId, entityType));</b>
&nbsp;    }
&nbsp;
&nbsp;    @ApiOperation(value = &quot;List all entities at version (listAllEntitiesAtVersion)&quot;, notes = &quot;&quot; +
&nbsp;            &quot;Returns a list of all remote entities available in a specific version. &quot; +
&nbsp;            &quot;Response type is the same as for listAllEntitiesAtVersion API method. \n&quot; +
&nbsp;            &quot;Returned entities order will be the same as in the repository.&quot; +
&nbsp;            TENANT_AUTHORITY_PARAGRAPH)
&nbsp;    @GetMapping(value = &quot;/entity/{versionId}&quot;)
&nbsp;    public DeferredResult&lt;List&lt;VersionedEntityInfo&gt;&gt; listAllEntitiesAtVersion(@Parameter(description = VERSION_ID_PARAM_DESCRIPTION, required = true)
&nbsp;                                                                              @PathVariable String versionId) throws Exception {
<b class="nc">&nbsp;        accessControlService.checkPermission(getCurrentUser(), Resource.VERSION_CONTROL, Operation.READ);</b>
<b class="nc">&nbsp;        return wrapFuture(versionControlService.listAllEntitiesAtVersion(getTenantId(), versionId));</b>
&nbsp;    }
&nbsp;
&nbsp;    @ApiOperation(value = &quot;Get entity data info (getEntityDataInfo)&quot;, notes = &quot;&quot; +
&nbsp;            &quot;Retrieves short info about the remote entity by external id at a concrete version. \n&quot; +
&nbsp;            &quot;Returned entity data info contains following properties: &quot; +
&nbsp;            &quot;`hasRelations` (whether stored entity data contains relations), `hasAttributes` (contains attributes) and &quot; +
&nbsp;            &quot;`hasCredentials` (whether stored device data has credentials).&quot; +
&nbsp;            TENANT_AUTHORITY_PARAGRAPH)
&nbsp;    @GetMapping(&quot;/info/{versionId}/{entityType}/{externalEntityUuid}&quot;)
&nbsp;    public DeferredResult&lt;EntityDataInfo&gt; getEntityDataInfo(@Parameter(description = VERSION_ID_PARAM_DESCRIPTION, required = true)
&nbsp;                                                            @PathVariable String versionId,
&nbsp;                                                            @Parameter(description = ENTITY_TYPE_PARAM_DESCRIPTION, required = true)
&nbsp;                                                            @PathVariable EntityType entityType,
&nbsp;                                                            @Parameter(description = &quot;A string value representing external entity id&quot;, required = true)
&nbsp;                                                            @PathVariable UUID externalEntityUuid) throws Exception {
<b class="nc">&nbsp;        accessControlService.checkPermission(getCurrentUser(), Resource.VERSION_CONTROL, Operation.READ);</b>
<b class="nc">&nbsp;        EntityId entityId = EntityIdFactory.getByTypeAndUuid(entityType, externalEntityUuid);</b>
<b class="nc">&nbsp;        return wrapFuture(versionControlService.getEntityDataInfo(getCurrentUser(), entityId, versionId));</b>
&nbsp;    }
&nbsp;
&nbsp;    @ApiOperation(value = &quot;Compare entity data to version (compareEntityDataToVersion)&quot;, notes = &quot;&quot; +
&nbsp;            &quot;Returns an object with current entity data and the one at a specific version. &quot; +
&nbsp;            &quot;Entity data structure is the same as stored in a repository. &quot; +
&nbsp;            TENANT_AUTHORITY_PARAGRAPH)
&nbsp;    @GetMapping(value = &quot;/diff/{entityType}/{internalEntityUuid}&quot;, params = {&quot;versionId&quot;})
&nbsp;    public DeferredResult&lt;EntityDataDiff&gt; compareEntityDataToVersion(@Parameter(description = ENTITY_TYPE_PARAM_DESCRIPTION, required = true)
&nbsp;                                                                     @PathVariable EntityType entityType,
&nbsp;                                                                     @Parameter(description = ENTITY_ID_PARAM_DESCRIPTION, required = true)
&nbsp;                                                                     @PathVariable UUID internalEntityUuid,
&nbsp;                                                                     @Parameter(description = VERSION_ID_PARAM_DESCRIPTION, required = true)
&nbsp;                                                                     @RequestParam String versionId) throws Exception {
<b class="nc">&nbsp;        accessControlService.checkPermission(getCurrentUser(), Resource.VERSION_CONTROL, Operation.READ);</b>
<b class="nc">&nbsp;        EntityId entityId = EntityIdFactory.getByTypeAndUuid(entityType, internalEntityUuid);</b>
<b class="nc">&nbsp;        return wrapFuture(versionControlService.compareEntityDataToVersion(getCurrentUser(), entityId, versionId));</b>
&nbsp;    }
&nbsp;
&nbsp;    @ApiOperation(value = &quot;Load entities version (loadEntitiesVersion)&quot;, notes = &quot;&quot; +
&nbsp;            &quot;Loads specific version of remote entities (or single entity) by request. &quot; +
&nbsp;            &quot;Supported entity types: CUSTOMER, ASSET, RULE_CHAIN, DASHBOARD, DEVICE_PROFILE, DEVICE, ENTITY_VIEW, WIDGETS_BUNDLE.&quot; + NEW_LINE +
&nbsp;            &quot;There are multiple types of request. Each of them requires branch name (`branch`) and version id (`versionId`). &quot; +
&nbsp;            &quot;Request of type `SINGLE_ENTITY` is needed to restore a concrete version of a specific entity. It contains &quot; +
&nbsp;            &quot;id of a remote entity (`externalEntityId`) and additional configuration (`config`):\n&quot; +
&nbsp;            &quot;- `loadRelations` - to update relations list (in case `saveRelations` option was enabled during version creation);\n&quot; +
&nbsp;            &quot;- `loadAttributes` - to load entity attributes (if `saveAttributes` config option was enabled);\n&quot; +
&nbsp;            &quot;- `loadCredentials` - to update device credentials (if `saveCredentials` option was enabled during version creation).&quot; + NEW_LINE +
&nbsp;            &quot;An example of such request:\n&quot; +
&nbsp;            MARKDOWN_CODE_BLOCK_START +
&nbsp;            &quot;{\n&quot; +
&nbsp;            &quot;  \&quot;type\&quot;: \&quot;SINGLE_ENTITY\&quot;,\n&quot; +
&nbsp;            &quot;  \n&quot; +
&nbsp;            &quot;  \&quot;branch\&quot;: \&quot;dev\&quot;,\n&quot; +
&nbsp;            &quot;  \&quot;versionId\&quot;: \&quot;b3c28d722d328324c7c15b0b30047b0c40011cf7\&quot;,\n&quot; +
&nbsp;            &quot;  \n&quot; +
&nbsp;            &quot;  \&quot;externalEntityId\&quot;: {\n&quot; +
&nbsp;            &quot;    \&quot;entityType\&quot;: \&quot;DEVICE\&quot;,\n&quot; +
&nbsp;            &quot;    \&quot;id\&quot;: \&quot;b7944123-d4f4-11ec-847b-0f432358ab48\&quot;\n&quot; +
&nbsp;            &quot;  },\n&quot; +
&nbsp;            &quot;  \&quot;config\&quot;: {\n&quot; +
&nbsp;            &quot;    \&quot;loadRelations\&quot;: false,\n&quot; +
&nbsp;            &quot;    \&quot;loadAttributes\&quot;: true,\n&quot; +
&nbsp;            &quot;    \&quot;loadCredentials\&quot;: true\n&quot; +
&nbsp;            &quot;  }\n&quot; +
&nbsp;            &quot;}&quot; +
&nbsp;            MARKDOWN_CODE_BLOCK_END + NEW_LINE +
&nbsp;            &quot;Another request type (`ENTITY_TYPE`) is needed to load specific version of the whole entity types. &quot; +
&nbsp;            &quot;It contains a structure with entity types to load and configs for each entity type (`entityTypes`). &quot; +
&nbsp;            &quot;For each specified entity type, the method will load all remote entities of this type that are present &quot; +
&nbsp;            &quot;at the version. A config for each entity type contains the same options as in `SINGLE_ENTITY` request type, and &quot; +
&nbsp;            &quot;additionally contains following options:\n&quot; +
&nbsp;            &quot;- `removeOtherEntities` - to remove local entities that are not present on the remote - basically to &quot; +
&nbsp;            &quot;   overwrite local entity type with the remote one;\n&quot; +
&nbsp;            &quot;- `findExistingEntityByName` - when you are loading some remote entities that are not yet present at this tenant, &quot; +
&nbsp;            &quot;   try to find existing entity by name and update it rather than create new.&quot; + NEW_LINE +
&nbsp;            &quot;Here is an example of the request to completely restore version of the whole device entity type:\n&quot; +
&nbsp;            MARKDOWN_CODE_BLOCK_START +
&nbsp;            &quot;{\n&quot; +
&nbsp;            &quot;  \&quot;type\&quot;: \&quot;ENTITY_TYPE\&quot;,\n&quot; +
&nbsp;            &quot;\n&quot; +
&nbsp;            &quot;  \&quot;branch\&quot;: \&quot;dev\&quot;,\n&quot; +
&nbsp;            &quot;  \&quot;versionId\&quot;: \&quot;b3c28d722d328324c7c15b0b30047b0c40011cf7\&quot;,\n&quot; +
&nbsp;            &quot;\n&quot; +
&nbsp;            &quot;  \&quot;entityTypes\&quot;: {\n&quot; +
&nbsp;            &quot;    \&quot;DEVICE\&quot;: {\n&quot; +
&nbsp;            &quot;      \&quot;removeOtherEntities\&quot;: true,\n&quot; +
&nbsp;            &quot;      \&quot;findExistingEntityByName\&quot;: false,\n&quot; +
&nbsp;            &quot;      \&quot;loadRelations\&quot;: true,\n&quot; +
&nbsp;            &quot;      \&quot;loadAttributes\&quot;: true,\n&quot; +
&nbsp;            &quot;      \&quot;loadCredentials\&quot;: true\n&quot; +
&nbsp;            &quot;    }\n&quot; +
&nbsp;            &quot;  }\n&quot; +
&nbsp;            &quot;}&quot; +
&nbsp;            MARKDOWN_CODE_BLOCK_END + NEW_LINE +
&nbsp;            &quot;The response will contain generated request UUID that is to be used to check the status of operation &quot; +
&nbsp;            &quot;via `getVersionLoadRequestStatus`.&quot; +
&nbsp;            TENANT_AUTHORITY_PARAGRAPH)
&nbsp;    @PostMapping(&quot;/entity&quot;)
&nbsp;    public UUID loadEntitiesVersion(@RequestBody VersionLoadRequest request) throws Exception {
<b class="nc">&nbsp;        SecurityUser user = getCurrentUser();</b>
<b class="nc">&nbsp;        accessControlService.checkPermission(user, Resource.VERSION_CONTROL, Operation.WRITE);</b>
<b class="nc">&nbsp;        return versionControlService.loadEntitiesVersion(user, request);</b>
&nbsp;    }
&nbsp;
&nbsp;    @ApiOperation(value = &quot;Get version load request status (getVersionLoadRequestStatus)&quot;, notes = &quot;&quot; +
&nbsp;            &quot;Returns the status of previously made version load request. &quot; +
&nbsp;            &quot;The structure contains following parameters:\n&quot; +
&nbsp;            &quot;- `done` - if the request was successfully processed;\n&quot; +
&nbsp;            &quot;- `result` - a list of load results for each entity type:\n&quot; +
&nbsp;            &quot;     - `created` - created entities count;\n&quot; +
&nbsp;            &quot;     - `updated` - updated entities count;\n&quot; +
&nbsp;            &quot;     - `deleted` - removed entities count.\n&quot; +
&nbsp;            &quot;- `error` - if an error occurred during processing, error info:\n&quot; +
&nbsp;            &quot;     - `type` - error type;\n&quot; +
&nbsp;            &quot;     - `source` - an external id of remote entity;\n&quot; +
&nbsp;            &quot;     - `target` - if failed to find referenced entity by external id - this external id;\n&quot; +
&nbsp;            &quot;     - `message` - error message.&quot; + NEW_LINE +
&nbsp;            &quot;An example of successfully processed request status:\n&quot; +
&nbsp;            MARKDOWN_CODE_BLOCK_START +
&nbsp;            &quot;{\n&quot; +
&nbsp;            &quot;  \&quot;done\&quot;: true,\n&quot; +
&nbsp;            &quot;  \&quot;result\&quot;: [\n&quot; +
&nbsp;            &quot;    {\n&quot; +
&nbsp;            &quot;      \&quot;entityType\&quot;: \&quot;DEVICE\&quot;,\n&quot; +
&nbsp;            &quot;      \&quot;created\&quot;: 10,\n&quot; +
&nbsp;            &quot;      \&quot;updated\&quot;: 5,\n&quot; +
&nbsp;            &quot;      \&quot;deleted\&quot;: 5\n&quot; +
&nbsp;            &quot;    },\n&quot; +
&nbsp;            &quot;     {\n&quot; +
&nbsp;            &quot;      \&quot;entityType\&quot;: \&quot;ASSET\&quot;,\n&quot; +
&nbsp;            &quot;      \&quot;created\&quot;: 4,\n&quot; +
&nbsp;            &quot;      \&quot;updated\&quot;: 0,\n&quot; +
&nbsp;            &quot;      \&quot;deleted\&quot;: 8\n&quot; +
&nbsp;            &quot;    }\n&quot; +
&nbsp;            &quot;  ]\n&quot; +
&nbsp;            &quot;}&quot; +
&nbsp;            MARKDOWN_CODE_BLOCK_END +
&nbsp;            TENANT_AUTHORITY_PARAGRAPH
&nbsp;    )
&nbsp;    @GetMapping(value = &quot;/entity/{requestId}/status&quot;)
&nbsp;    public VersionLoadResult getVersionLoadRequestStatus(@Parameter(description = VC_REQUEST_ID_PARAM_DESCRIPTION, required = true)
&nbsp;                                                         @PathVariable UUID requestId) throws Exception {
<b class="nc">&nbsp;        accessControlService.checkPermission(getCurrentUser(), Resource.VERSION_CONTROL, Operation.WRITE);</b>
<b class="nc">&nbsp;        return versionControlService.getVersionLoadStatus(getCurrentUser(), requestId);</b>
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;    @ApiOperation(value = &quot;List branches (listBranches)&quot;, notes = &quot;&quot; +
&nbsp;            &quot;Lists branches available in the remote repository. \n\n&quot; +
&nbsp;            &quot;Response example: \n&quot; +
&nbsp;            MARKDOWN_CODE_BLOCK_START +
&nbsp;            &quot;[\n&quot; +
&nbsp;            &quot;  {\n&quot; +
&nbsp;            &quot;    \&quot;name\&quot;: \&quot;master\&quot;,\n&quot; +
&nbsp;            &quot;    \&quot;default\&quot;: true\n&quot; +
&nbsp;            &quot;  },\n&quot; +
&nbsp;            &quot;  {\n&quot; +
&nbsp;            &quot;    \&quot;name\&quot;: \&quot;dev\&quot;,\n&quot; +
&nbsp;            &quot;    \&quot;default\&quot;: false\n&quot; +
&nbsp;            &quot;  },\n&quot; +
&nbsp;            &quot;  {\n&quot; +
&nbsp;            &quot;    \&quot;name\&quot;: \&quot;dev-2\&quot;,\n&quot; +
&nbsp;            &quot;    \&quot;default\&quot;: false\n&quot; +
&nbsp;            &quot;  }\n&quot; +
&nbsp;            &quot;]&quot; +
&nbsp;            MARKDOWN_CODE_BLOCK_END)
&nbsp;    @GetMapping(&quot;/branches&quot;)
&nbsp;    public DeferredResult&lt;List&lt;BranchInfo&gt;&gt; listBranches() throws Exception {
<b class="nc">&nbsp;        accessControlService.checkPermission(getCurrentUser(), Resource.VERSION_CONTROL, Operation.READ);</b>
<b class="nc">&nbsp;        final TenantId tenantId = getTenantId();</b>
<b class="nc">&nbsp;        ListenableFuture&lt;List&lt;BranchInfo&gt;&gt; branches = versionControlService.listBranches(tenantId);</b>
<b class="nc">&nbsp;        return wrapFuture(Futures.transform(branches, remoteBranches -&gt; {</b>
<b class="nc">&nbsp;            List&lt;BranchInfo&gt; infos = new ArrayList&lt;&gt;();</b>
&nbsp;            BranchInfo defaultBranch;
<b class="nc">&nbsp;            String defaultBranchName = versionControlService.getVersionControlSettings(tenantId).getDefaultBranch();</b>
<b class="nc">&nbsp;            if (StringUtils.isNotEmpty(defaultBranchName)) {</b>
<b class="nc">&nbsp;                defaultBranch = new BranchInfo(defaultBranchName, true);</b>
&nbsp;            } else {
<b class="nc">&nbsp;                defaultBranch = remoteBranches.stream().filter(BranchInfo::isDefault).findFirst().orElse(null);</b>
&nbsp;            }
<b class="nc">&nbsp;            if (defaultBranch != null) {</b>
<b class="nc">&nbsp;                infos.add(defaultBranch);</b>
&nbsp;            }
<b class="nc">&nbsp;            infos.addAll(remoteBranches.stream().filter(b -&gt; !b.equals(defaultBranch))</b>
<b class="nc">&nbsp;                    .map(b -&gt; new BranchInfo(b.getName(), false)).collect(Collectors.toList()));</b>
<b class="nc">&nbsp;            return infos;</b>
<b class="nc">&nbsp;        }, MoreExecutors.directExecutor()));</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    protected &lt;T&gt; DeferredResult&lt;T&gt; wrapFuture(ListenableFuture&lt;T&gt; future) {
<b class="nc">&nbsp;        return wrapFuture(future, vcRequestTimeout);</b>
&nbsp;    }
&nbsp;
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2026-02-07 20:03</div>
</div>
</body>
</html>
