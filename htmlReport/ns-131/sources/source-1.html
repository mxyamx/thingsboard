<!--

    Copyright © 2016-2026 The Thingsboard Authors

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

        http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.

-->



<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> 
  <title>Coverage Report > WidgetTypeServiceImpl</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">org.thingsboard.server.dao.widget</a>
</div>

<h1>Coverage Summary for Class: WidgetTypeServiceImpl (org.thingsboard.server.dao.widget)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Branch, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">WidgetTypeServiceImpl</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/27)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/12)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/107)
  </span>
</td>
</tr>
  <tr>
    <td class="name">WidgetTypeServiceImpl$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/8)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">WidgetTypeServiceImpl$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/33)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/12)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/118)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;/**
&nbsp; * Copyright © 2016-2026 The Thingsboard Authors
&nbsp; *
&nbsp; * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
&nbsp; * you may not use this file except in compliance with the License.
&nbsp; * You may obtain a copy of the License at
&nbsp; *
&nbsp; *     http://www.apache.org/licenses/LICENSE-2.0
&nbsp; *
&nbsp; * Unless required by applicable law or agreed to in writing, software
&nbsp; * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
&nbsp; * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
&nbsp; * See the License for the specific language governing permissions and
&nbsp; * limitations under the License.
&nbsp; */
&nbsp;package org.thingsboard.server.dao.widget;
&nbsp;
&nbsp;import com.google.common.util.concurrent.FluentFuture;
&nbsp;import lombok.extern.slf4j.Slf4j;
&nbsp;import org.apache.commons.collections4.CollectionUtils;
&nbsp;import org.springframework.beans.factory.annotation.Autowired;
&nbsp;import org.springframework.context.ApplicationEventPublisher;
&nbsp;import org.springframework.stereotype.Service;
&nbsp;import org.thingsboard.server.common.data.EntityType;
&nbsp;import org.thingsboard.server.common.data.id.EntityId;
&nbsp;import org.thingsboard.server.common.data.id.HasId;
&nbsp;import org.thingsboard.server.common.data.id.TenantId;
&nbsp;import org.thingsboard.server.common.data.id.WidgetTypeId;
&nbsp;import org.thingsboard.server.common.data.id.WidgetsBundleId;
&nbsp;import org.thingsboard.server.common.data.page.PageData;
&nbsp;import org.thingsboard.server.common.data.page.PageLink;
&nbsp;import org.thingsboard.server.common.data.widget.DeprecatedFilter;
&nbsp;import org.thingsboard.server.common.data.widget.WidgetType;
&nbsp;import org.thingsboard.server.common.data.widget.WidgetTypeDetails;
&nbsp;import org.thingsboard.server.common.data.widget.WidgetTypeFilter;
&nbsp;import org.thingsboard.server.common.data.widget.WidgetTypeInfo;
&nbsp;import org.thingsboard.server.common.data.widget.WidgetsBundleWidget;
&nbsp;import org.thingsboard.server.dao.entity.AbstractCachedEntityService;
&nbsp;import org.thingsboard.server.dao.eventsourcing.DeleteEntityEvent;
&nbsp;import org.thingsboard.server.dao.eventsourcing.SaveEntityEvent;
&nbsp;import org.thingsboard.server.dao.resource.ImageService;
&nbsp;import org.thingsboard.server.dao.resource.ResourceService;
&nbsp;import org.thingsboard.server.dao.service.DataValidator;
&nbsp;import org.thingsboard.server.dao.service.PaginatedRemover;
&nbsp;import org.thingsboard.server.dao.service.Validator;
&nbsp;
&nbsp;import java.util.ArrayList;
&nbsp;import java.util.List;
&nbsp;import java.util.Optional;
&nbsp;
&nbsp;import static com.google.common.util.concurrent.MoreExecutors.directExecutor;
&nbsp;import static org.thingsboard.server.dao.service.Validator.validateIds;
&nbsp;
&nbsp;@Service(&quot;WidgetTypeDaoService&quot;)
<b class="nc">&nbsp;@Slf4j</b>
<b class="nc">&nbsp;public class WidgetTypeServiceImpl implements WidgetTypeService {</b>
&nbsp;
&nbsp;    public static final String INCORRECT_TENANT_ID = &quot;Incorrect tenantId &quot;;
&nbsp;    public static final String INCORRECT_WIDGETS_BUNDLE_ID = &quot;Incorrect widgetsBundleId &quot;;
&nbsp;
&nbsp;    @Autowired
&nbsp;    private WidgetTypeDao widgetTypeDao;
&nbsp;
&nbsp;    @Autowired
&nbsp;    private DataValidator&lt;WidgetTypeDetails&gt; widgetTypeValidator;
&nbsp;
&nbsp;    @Autowired
&nbsp;    protected ApplicationEventPublisher eventPublisher;
&nbsp;
&nbsp;    @Autowired
&nbsp;    protected ImageService imageService;
&nbsp;
&nbsp;    @Autowired
&nbsp;    private ResourceService resourceService;
&nbsp;
&nbsp;    @Override
&nbsp;    public WidgetType findWidgetTypeById(TenantId tenantId, WidgetTypeId widgetTypeId) {
<b class="nc">&nbsp;        log.trace(&quot;Executing findWidgetTypeById [{}]&quot;, widgetTypeId);</b>
<b class="nc">&nbsp;        Validator.validateId(widgetTypeId, id -&gt; &quot;Incorrect widgetTypeId &quot; + id);</b>
<b class="nc">&nbsp;        return widgetTypeDao.findWidgetTypeById(tenantId, widgetTypeId.getId());</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public WidgetTypeDetails findWidgetTypeDetailsById(TenantId tenantId, WidgetTypeId widgetTypeId) {
<b class="nc">&nbsp;        log.trace(&quot;Executing findWidgetTypeDetailsById [{}]&quot;, widgetTypeId);</b>
<b class="nc">&nbsp;        Validator.validateId(widgetTypeId, id -&gt; &quot;Incorrect widgetTypeId &quot; + id);</b>
<b class="nc">&nbsp;        return widgetTypeDao.findById(tenantId, widgetTypeId.getId());</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public WidgetTypeInfo findWidgetTypeInfoById(TenantId tenantId, WidgetTypeId widgetTypeId) {
<b class="nc">&nbsp;        log.trace(&quot;Executing findWidgetTypeInfoById [{}]&quot;, widgetTypeId);</b>
<b class="nc">&nbsp;        Validator.validateId(widgetTypeId, id -&gt; &quot;Incorrect widgetTypeId &quot; + id);</b>
<b class="nc">&nbsp;        return widgetTypeDao.findWidgetTypeInfoById(tenantId, widgetTypeId.getId());</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public boolean widgetTypeExistsByTenantIdAndWidgetTypeId(TenantId tenantId, WidgetTypeId widgetTypeId) {
<b class="nc">&nbsp;        log.trace(&quot;Executing widgetTypeExistsByTenantIdAndWidgetTypeId, tenantId [{}],  widgetTypeId [{}]&quot;, tenantId, widgetTypeId);</b>
<b class="nc">&nbsp;        Validator.validateId(widgetTypeId, id -&gt; &quot;Incorrect widgetTypeId &quot; + id);</b>
<b class="nc">&nbsp;        return widgetTypeDao.existsByTenantIdAndId(tenantId, widgetTypeId.getId());</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public WidgetTypeDetails saveWidgetType(WidgetTypeDetails widgetTypeDetails) {
<b class="nc">&nbsp;        log.trace(&quot;Executing saveWidgetType [{}]&quot;, widgetTypeDetails);</b>
<b class="nc">&nbsp;        widgetTypeValidator.validate(widgetTypeDetails, WidgetType::getTenantId);</b>
&nbsp;        try {
<b class="nc">&nbsp;            TenantId tenantId = widgetTypeDetails.getTenantId();</b>
<b class="nc">&nbsp;            if (CollectionUtils.isNotEmpty(widgetTypeDetails.getResources())) {</b>
<b class="nc">&nbsp;                resourceService.importResources(tenantId, widgetTypeDetails.getResources());</b>
&nbsp;            }
<b class="nc">&nbsp;            imageService.updateImagesUsage(widgetTypeDetails);</b>
<b class="nc">&nbsp;            resourceService.updateResourcesUsage(tenantId, widgetTypeDetails);</b>
&nbsp;
<b class="nc">&nbsp;            WidgetTypeDetails result = widgetTypeDao.save(tenantId, widgetTypeDetails);</b>
<b class="nc">&nbsp;            eventPublisher.publishEvent(SaveEntityEvent.builder().tenantId(tenantId)</b>
<b class="nc">&nbsp;                    .entityId(result.getId()).created(widgetTypeDetails.getId() == null).build());</b>
<b class="nc">&nbsp;            return result;</b>
&nbsp;        } catch (Exception t) {
<b class="nc">&nbsp;            AbstractCachedEntityService.checkConstraintViolation(t,</b>
&nbsp;                    &quot;uq_widget_type_fqn&quot;, &quot;Widget type with such fqn already exists!&quot;);
<b class="nc">&nbsp;            AbstractCachedEntityService.checkConstraintViolation(t, &quot;widget_type_external_id_unq_key&quot;, &quot;Widget type with such external id already exists!&quot;);</b>
&nbsp;            throw t;
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public void deleteWidgetType(TenantId tenantId, WidgetTypeId widgetTypeId) {
<b class="nc">&nbsp;        log.trace(&quot;Executing deleteWidgetType [{}]&quot;, widgetTypeId);</b>
<b class="nc">&nbsp;        Validator.validateId(widgetTypeId, id -&gt; &quot;Incorrect widgetTypeId &quot; + id);</b>
<b class="nc">&nbsp;        widgetTypeDao.removeById(tenantId, widgetTypeId.getId());</b>
<b class="nc">&nbsp;        eventPublisher.publishEvent(DeleteEntityEvent.builder().tenantId(tenantId).entityId(widgetTypeId).build());</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public void deleteEntity(TenantId tenantId, EntityId id, boolean force) {
<b class="nc">&nbsp;        deleteWidgetType(tenantId, (WidgetTypeId) id);</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public PageData&lt;WidgetTypeInfo&gt; findSystemWidgetTypesByPageLink(WidgetTypeFilter widgetTypeFilter, PageLink pageLink) {
<b class="nc">&nbsp;        log.trace(&quot;Executing findSystemWidgetTypesByPageLink, pageLink [{}]&quot;, pageLink);</b>
<b class="nc">&nbsp;        Validator.validatePageLink(pageLink);</b>
<b class="nc">&nbsp;        return widgetTypeDao.findSystemWidgetTypes(widgetTypeFilter, pageLink);</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public PageData&lt;WidgetTypeInfo&gt; findAllTenantWidgetTypesByTenantIdAndPageLink(WidgetTypeFilter widgetTypeFilter, PageLink pageLink) {
<b class="nc">&nbsp;        TenantId tenantId = widgetTypeFilter.getTenantId();</b>
<b class="nc">&nbsp;        log.trace(&quot;Executing findAllTenantWidgetTypesByTenantIdAndPageLink, tenantId [{}], pageLink [{}]&quot;,</b>
&nbsp;                tenantId, pageLink);
<b class="nc">&nbsp;        Validator.validateId(tenantId, id -&gt; INCORRECT_TENANT_ID + id);</b>
<b class="nc">&nbsp;        Validator.validatePageLink(pageLink);</b>
<b class="nc">&nbsp;        return widgetTypeDao.findAllTenantWidgetTypesByTenantId(widgetTypeFilter, pageLink);</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public PageData&lt;WidgetTypeInfo&gt; findTenantWidgetTypesByTenantIdAndPageLink(WidgetTypeFilter widgetTypeFilter, PageLink pageLink) {
<b class="nc">&nbsp;        TenantId tenantId = widgetTypeFilter.getTenantId();</b>
<b class="nc">&nbsp;        log.trace(&quot;Executing findTenantWidgetTypesByTenantIdAndPageLink, tenantId [{}], pageLink [{}]&quot;,</b>
&nbsp;                tenantId, pageLink);
<b class="nc">&nbsp;        Validator.validateId(tenantId, id -&gt; INCORRECT_TENANT_ID + id);</b>
<b class="nc">&nbsp;        Validator.validatePageLink(pageLink);</b>
<b class="nc">&nbsp;        return widgetTypeDao.findTenantWidgetTypesByTenantId(widgetTypeFilter, pageLink);</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public List&lt;WidgetType&gt; findWidgetTypesByWidgetsBundleId(TenantId tenantId, WidgetsBundleId widgetsBundleId) {
<b class="nc">&nbsp;        log.trace(&quot;Executing findWidgetTypesByWidgetsBundleId, tenantId [{}], widgetsBundleId [{}]&quot;, tenantId, widgetsBundleId);</b>
<b class="nc">&nbsp;        Validator.validateId(tenantId, id -&gt; INCORRECT_TENANT_ID + id);</b>
<b class="nc">&nbsp;        Validator.validateId(widgetsBundleId, id -&gt; INCORRECT_WIDGETS_BUNDLE_ID + id);</b>
<b class="nc">&nbsp;        return widgetTypeDao.findWidgetTypesByWidgetsBundleId(tenantId.getId(), widgetsBundleId.getId());</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public List&lt;WidgetTypeDetails&gt; findWidgetTypesDetailsByWidgetsBundleId(TenantId tenantId, WidgetsBundleId widgetsBundleId) {
<b class="nc">&nbsp;        log.trace(&quot;Executing findWidgetTypesDetailsByWidgetsBundleId, tenantId [{}], widgetsBundleId [{}]&quot;, tenantId, widgetsBundleId);</b>
<b class="nc">&nbsp;        Validator.validateId(tenantId, id -&gt; INCORRECT_TENANT_ID + id);</b>
<b class="nc">&nbsp;        Validator.validateId(widgetsBundleId, id -&gt; INCORRECT_WIDGETS_BUNDLE_ID + id);</b>
<b class="nc">&nbsp;        return widgetTypeDao.findWidgetTypesDetailsByWidgetsBundleId(tenantId.getId(), widgetsBundleId.getId());</b>
&nbsp;
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public PageData&lt;WidgetTypeInfo&gt; findWidgetTypesInfosByWidgetsBundleId(TenantId tenantId, WidgetsBundleId widgetsBundleId, boolean fullSearch,
&nbsp;                                                                          DeprecatedFilter deprecatedFilter, List&lt;String&gt; widgetTypes, PageLink pageLink) {
<b class="nc">&nbsp;        log.trace(&quot;Executing findWidgetTypesInfosByWidgetsBundleId, tenantId [{}], widgetsBundleId [{}], fullSearch [{}], deprecatedFilter [{}], widgetTypes [{}], pageLink [{}]&quot;,</b>
<b class="nc">&nbsp;                tenantId, widgetsBundleId, fullSearch, deprecatedFilter, widgetTypes, pageLink);</b>
<b class="nc">&nbsp;        Validator.validateId(tenantId, id -&gt; INCORRECT_TENANT_ID + id);</b>
<b class="nc">&nbsp;        Validator.validateId(widgetsBundleId, id -&gt; INCORRECT_WIDGETS_BUNDLE_ID + id);</b>
<b class="nc">&nbsp;        Validator.validatePageLink(pageLink);</b>
<b class="nc">&nbsp;        return widgetTypeDao.findWidgetTypesInfosByWidgetsBundleId(tenantId.getId(), widgetsBundleId.getId(), fullSearch, deprecatedFilter, widgetTypes, pageLink);</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public List&lt;String&gt; findWidgetFqnsByWidgetsBundleId(TenantId tenantId, WidgetsBundleId widgetsBundleId) {
<b class="nc">&nbsp;        log.trace(&quot;Executing findWidgetTypesInfosByWidgetsBundleId, tenantId [{}], widgetsBundleId [{}]&quot;, tenantId, widgetsBundleId);</b>
<b class="nc">&nbsp;        Validator.validateId(tenantId, id -&gt; INCORRECT_TENANT_ID + id);</b>
<b class="nc">&nbsp;        Validator.validateId(widgetsBundleId, id -&gt; INCORRECT_WIDGETS_BUNDLE_ID + id);</b>
<b class="nc">&nbsp;        return widgetTypeDao.findWidgetFqnsByWidgetsBundleId(tenantId.getId(), widgetsBundleId.getId());</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public WidgetType findWidgetTypeByTenantIdAndFqn(TenantId tenantId, String fqn) {
<b class="nc">&nbsp;        log.trace(&quot;Executing findWidgetTypeByTenantIdAndFqn, tenantId [{}], fqn [{}]&quot;, tenantId, fqn);</b>
<b class="nc">&nbsp;        Validator.validateId(tenantId, id -&gt; INCORRECT_TENANT_ID + id);</b>
<b class="nc">&nbsp;        Validator.validateString(fqn, f -&gt; &quot;Incorrect fqn &quot; + f);</b>
<b class="nc">&nbsp;        return widgetTypeDao.findByTenantIdAndFqn(tenantId.getId(), fqn);</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public WidgetTypeDetails findWidgetTypeDetailsByTenantIdAndFqn(TenantId tenantId, String fqn) {
<b class="nc">&nbsp;        log.trace(&quot;Executing findWidgetTypeDetailsByTenantIdAndFqn, tenantId [{}], fqn [{}]&quot;, tenantId, fqn);</b>
<b class="nc">&nbsp;        Validator.validateId(tenantId, id -&gt; INCORRECT_TENANT_ID + id);</b>
<b class="nc">&nbsp;        Validator.validateString(fqn, f -&gt; &quot;Incorrect fqn &quot; + f);</b>
<b class="nc">&nbsp;        return widgetTypeDao.findDetailsByTenantIdAndFqn(tenantId.getId(), fqn);</b>
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;    @Override
&nbsp;    public void updateWidgetsBundleWidgetTypes(TenantId tenantId, WidgetsBundleId widgetsBundleId, List&lt;WidgetTypeId&gt; widgetTypeIds) {
<b class="nc">&nbsp;        log.trace(&quot;Executing updateWidgetsBundleWidgetTypes, tenantId [{}], widgetsBundleId [{}], widgetTypeIds [{}]&quot;, tenantId, widgetsBundleId, widgetTypeIds);</b>
<b class="nc">&nbsp;        Validator.validateId(tenantId, id -&gt; INCORRECT_TENANT_ID + id);</b>
<b class="nc">&nbsp;        Validator.validateId(widgetsBundleId, id -&gt; INCORRECT_WIDGETS_BUNDLE_ID + id);</b>
<b class="nc">&nbsp;        Validator.checkNotNull(widgetTypeIds, &quot;Incorrect widgetTypeIds &quot; + widgetTypeIds);</b>
<b class="nc">&nbsp;        if (!widgetTypeIds.isEmpty()) {</b>
<b class="nc">&nbsp;            validateIds(widgetTypeIds, ids -&gt; &quot;Incorrect widgetTypeIds &quot; + ids);</b>
&nbsp;        }
<b class="nc">&nbsp;        List&lt;WidgetsBundleWidget&gt; bundleWidgets = new ArrayList&lt;&gt;();</b>
<b class="nc">&nbsp;        for (int index = 0; index &lt; widgetTypeIds.size(); index++) {</b>
<b class="nc">&nbsp;            bundleWidgets.add(new WidgetsBundleWidget(widgetsBundleId, widgetTypeIds.get(index), index));</b>
&nbsp;        }
<b class="nc">&nbsp;        List&lt;WidgetsBundleWidget&gt; existingBundleWidgets = widgetTypeDao.findWidgetsBundleWidgetsByWidgetsBundleId(tenantId.getId(), widgetsBundleId.getId());</b>
<b class="nc">&nbsp;        List&lt;WidgetTypeId&gt; toRemove = existingBundleWidgets.stream()</b>
<b class="nc">&nbsp;                .map(WidgetsBundleWidget::getWidgetTypeId)</b>
<b class="nc">&nbsp;                .filter(widgetTypeId -&gt; bundleWidgets.stream().noneMatch(newBundleWidget -&gt;</b>
<b class="nc">&nbsp;                        newBundleWidget.getWidgetTypeId().equals(widgetTypeId))).toList();</b>
<b class="nc">&nbsp;        for (WidgetTypeId widgetTypeId : toRemove) {</b>
<b class="nc">&nbsp;            widgetTypeDao.removeWidgetTypeFromWidgetsBundle(widgetsBundleId.getId(), widgetTypeId.getId());</b>
&nbsp;        }
<b class="nc">&nbsp;        for (WidgetsBundleWidget widgetsBundleWidget : bundleWidgets) {</b>
<b class="nc">&nbsp;            widgetTypeDao.saveWidgetsBundleWidget(widgetsBundleWidget);</b>
&nbsp;        }
<b class="nc">&nbsp;        eventPublisher.publishEvent(SaveEntityEvent.builder().tenantId(tenantId)</b>
<b class="nc">&nbsp;                .entityId(widgetsBundleId).created(false).build());</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public void updateWidgetsBundleWidgetFqns(TenantId tenantId, WidgetsBundleId widgetsBundleId, List&lt;String&gt; widgetFqns) {
<b class="nc">&nbsp;        log.trace(&quot;Executing updateWidgetsBundleWidgetFqns, tenantId [{}], widgetsBundleId [{}], widgetFqns [{}]&quot;, tenantId, widgetsBundleId, widgetFqns);</b>
<b class="nc">&nbsp;        List&lt;WidgetTypeId&gt; widgetTypeIds = widgetTypeDao.findWidgetTypeIdsByTenantIdAndFqns(tenantId.getId(), widgetFqns);</b>
<b class="nc">&nbsp;        this.updateWidgetsBundleWidgetTypes(tenantId, widgetsBundleId, widgetTypeIds);</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public void deleteWidgetTypesByTenantId(TenantId tenantId) {
<b class="nc">&nbsp;        log.trace(&quot;Executing deleteWidgetTypesByTenantId, tenantId [{}]&quot;, tenantId);</b>
<b class="nc">&nbsp;        Validator.validateId(tenantId, id -&gt; INCORRECT_TENANT_ID + id);</b>
<b class="nc">&nbsp;        tenantWidgetTypeRemover.removeEntities(tenantId, tenantId);</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public void deleteWidgetTypesByBundleId(TenantId tenantId, WidgetsBundleId bundleId) {
<b class="nc">&nbsp;        log.trace(&quot;Executing deleteWidgetTypesByBundleId, tenantId [{}], bundleId [{}]&quot;, tenantId, bundleId);</b>
<b class="nc">&nbsp;        bundleWidgetTypesRemover.removeEntities(tenantId, bundleId);</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public PageData&lt;WidgetTypeId&gt; findAllWidgetTypesIds(PageLink pageLink) {
<b class="nc">&nbsp;        return widgetTypeDao.findAllWidgetTypesIds(pageLink);</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public void deleteByTenantId(TenantId tenantId) {
<b class="nc">&nbsp;        deleteWidgetTypesByTenantId(tenantId);</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public Optional&lt;HasId&lt;?&gt;&gt; findEntity(TenantId tenantId, EntityId entityId) {
<b class="nc">&nbsp;        return Optional.ofNullable(findWidgetTypeById(tenantId, new WidgetTypeId(entityId.getId())));</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public FluentFuture&lt;Optional&lt;HasId&lt;?&gt;&gt;&gt; findEntityAsync(TenantId tenantId, EntityId entityId) {
<b class="nc">&nbsp;        return FluentFuture.from(widgetTypeDao.findByIdAsync(tenantId, entityId.getId()))</b>
<b class="nc">&nbsp;                .transform(Optional::ofNullable, directExecutor());</b>
&nbsp;    }
&nbsp;
&nbsp;    @Override
&nbsp;    public EntityType getEntityType() {
<b class="nc">&nbsp;        return EntityType.WIDGET_TYPE;</b>
&nbsp;    }
&nbsp;
<b class="nc">&nbsp;    private final PaginatedRemover&lt;TenantId, WidgetTypeInfo&gt; tenantWidgetTypeRemover = new PaginatedRemover&lt;&gt;() {</b>
&nbsp;
&nbsp;        @Override
&nbsp;        protected PageData&lt;WidgetTypeInfo&gt; findEntities(TenantId tenantId, TenantId id, PageLink pageLink) {
<b class="nc">&nbsp;            return widgetTypeDao.findTenantWidgetTypesByTenantId(</b>
<b class="nc">&nbsp;                    WidgetTypeFilter.builder()</b>
<b class="nc">&nbsp;                            .tenantId(id)</b>
<b class="nc">&nbsp;                            .fullSearch(false)</b>
<b class="nc">&nbsp;                            .deprecatedFilter(DeprecatedFilter.ALL)</b>
<b class="nc">&nbsp;                            .widgetTypes(null).build(),</b>
&nbsp;                    pageLink);
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        protected void removeEntity(TenantId tenantId, WidgetTypeInfo entity) {
<b class="nc">&nbsp;            deleteWidgetType(tenantId, new WidgetTypeId(entity.getUuidId()));</b>
&nbsp;        }
&nbsp;
&nbsp;    };
&nbsp;
<b class="nc">&nbsp;    private final PaginatedRemover&lt;WidgetsBundleId, WidgetTypeInfo&gt; bundleWidgetTypesRemover = new PaginatedRemover&lt;&gt;() {</b>
&nbsp;
&nbsp;        @Override
&nbsp;        protected PageData&lt;WidgetTypeInfo&gt; findEntities(TenantId tenantId, WidgetsBundleId widgetsBundleId, PageLink pageLink) {
<b class="nc">&nbsp;            return findWidgetTypesInfosByWidgetsBundleId(tenantId, widgetsBundleId, false, DeprecatedFilter.ALL, null, pageLink);</b>
&nbsp;        }
&nbsp;
&nbsp;        @Override
&nbsp;        protected void removeEntity(TenantId tenantId, WidgetTypeInfo widgetTypeInfo) {
<b class="nc">&nbsp;            deleteWidgetType(tenantId, widgetTypeInfo.getId());</b>
&nbsp;        }
&nbsp;
&nbsp;    };
&nbsp;
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2026-02-07 20:03</div>
</div>
</body>
</html>
